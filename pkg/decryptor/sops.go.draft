package decryptor

import "bytes"

// Initialize a new SOPS Decryptor
func NewSOPSDecryptor(config ejsonDecryptorConfig, keys ...string) *EjsonDecryptor {
	init := &EjsonDecryptor{
		keys:   []string{},
		Config: config,
	}

	// Static Keys
	if len(keys) > 0 {
		init.AddKeys(keys)
	}

	return init
}

// File is sops encrypted
func IsEncrypted(data []byte) bool {
	return bytes.Contains(data, []byte("sops:"))
}
